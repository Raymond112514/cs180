---
layout: post
---

## Face morphing

### Overview

The goal of this project is to morph two faces to create a new one. A naive approach is to directly average the two faces, as shown in Figure 1. However, this method generally does not work well because the two images are often not aligned. To morph two images, we need to follow two steps: alignment and color blending. We will walk through each of these steps in detail in this project.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/naive_align.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Blended image by taking direct average. Note that the faces are not aligned.</p>

### Morphing two faces

#### Defining correspondence

To align the two images, we start by labeling key points on both images. These points will serve as landmarks for the morphing process. Next, we apply Delaunay triangulation using the `scipy.spatial.Delaunay` library. We use the average key points to compute the triangulation, making it less dependent on the individual images. In the next section, we will map the pixel intensity values from the midway triangle to the corresponding original triangles to perform warping (Figure 2).

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/example.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Illustration of the process: We map the triangle formed by the midway key points (b) to the corresponding triangle in the original image (a). The pixel intensity values are interpolated.</p>

The key points for the two images and the triangulation of the midway image are shown below.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/triangles.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 3:</strong> Triangulation of the original images (a), (b), and the midway image (c).</p>

#### Computing midway face

As an initial example, we first compute the midway face of the two images. To do this, we begin by warping the images to align them. After warping, we then average the pixel values to blend the colors, resulting in the midway face.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/midway.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 4:</strong> Midway face after alignment.</p>

#### The morph sequence

We can now apply the same methods to compute the morphed image by varying the warp fraction $\alpha$ and the dissolve fraction $\beta$. The following animation is generated by changing $\alpha$ and $\beta$ in regular intervals of $0.43$ within the range $[0,1]$.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/isaac_vincent_warped_dissolved.gif" alt="Image 1" style="width: 40%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 5:</strong> Morphed image with varying warp and dissolve fraction.</p>

### The mean face of a population

We now move on to morphing images to the mean face of a population. To compute the mean face, we used the IMM face dataset, which consists of faces of different individuals. We compute the mean face by first averaging the keypoints from all images, then warping each image to the mean geometry, then average the faces across all individuals. This gives us 
