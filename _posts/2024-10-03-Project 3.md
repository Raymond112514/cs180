---
layout: post
---

## Face morphing

### Overview

The goal of this project is to morph two faces to form a new face. One naive way is to directly take the average of two faces, as shown in Figure 1. This method, however, does not work well in general since the two images are often aligned. To morph two images, we therefore need two steps: alignment and color dissolving. In this project we will go through the process. 

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/naive_align.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Gradient magnitude and direction.</p>


### Morphing two faces

#### Defining correspondence

To align two images, we start by labeling keypoints for both images. These points will act as a landmark for later morphing. Next, we apply Deluaney triangulation using the Deluaney library. We used the average keypoints to compute the traingulation to make the triangulation less dependent on each images. Next, we map the pixel intensity values in the midway triangle to the original triangle.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/example.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Gradient magnitude and direction.</p>



<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/triangles.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Gradient magnitude and direction.</p>

#### Computing midway face

As a starting example, we can first compute the midway face of the two images. To do so, we estimate a linear map between two corresponding triangles and then map the triangles in the target images to the source image. After warping two images, we then average the pixels to dissolve the color, giving us the midway shape. 

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/midway.png" alt="Image 1" style="width: 90%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Gradient magnitude and direction.</p>

#### The morph sequence

We can now apply the same methods to compute the morphed image besides halfway image.

<div style="display: flex; justify-content: center;">   
   <img src="{{ site.baseurl }}/assets/proj3_images/isaac_vincent_warped_dissolved.gif" alt="Image 1" style="width: 40%; height: auto;"> 
</div> 
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Gradient magnitude and direction.</p>


