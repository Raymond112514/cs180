---
layout: post
---

## Fun with Filters and Frequencies

### Fun with filters

Filter is one of the most fundamental operation in image processing. We can use filters to extract different information. One of the most common filter is the gradient filter, defined as

$$\mathbf{D}_x = \begin{bmatrix} -1 & 1 \\
\end{bmatrix} \hspace{20mm} \mathbf{D}_y= \begin{bmatrix}
-1\\
1
\end{bmatrix}$$

Note that the gradient filter is essentially a first order approximation of the partial derivaties. Applying the derivative to the cameraman image, we see that the filter captures edge information in the $x$ and $y$ direction since intuitively, the derivative signal is large when neighboring pixels differ in intensity by much.

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_x.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_y.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

We can also compute the magnitude and direction of gradient, given by 

$$\begin{align*}
||\nabla I||_2 &= \sqrt{\bigg(\frac{\partial I}{\partial x}\bigg)^2 + \bigg(\frac{\partial I}{\partial y}\bigg)^2}\\
\theta &= \tan^{-1}(\frac{\partial I}{\partial y}\bigg/\frac{\partial I}{\partial x})
\end{align*}$$

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_magnitude.jpg" alt="Image 1" style="width: 40%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_dir.jpg" alt="Image 2" style="width: 40%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

We can filter out the edge by searching for a threshold $\tau$ and consider $\|\nabla I\|_2 \geq \tau$. Searching over $\tau\in \(0, 10^{-3}\)$, we see that $\tau=0.1929$ gives us the edges.

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_0.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_1.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_2.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Note that the edge signal extracted is low. This is caused by the presence of high frequency componenets in the image. To address this, we can consider blurring the image to remove those high frequency components. This can be done by first passing the Gaussian filter to the image then compute the gradient. Formally, we compute $\mathbf{D}_x \circ G (I)$ and $\mathbf{D}_y \circ G (I)$. 

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_x.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_y.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_magnitude.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Another way of performing the operation is to combine the derivate filter and the Gaussian filter together, giving us the derivative of Gaussian (DoG) filter. This gives us the same results.

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_dog_x.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_dog_y.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_dog_magnitude.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>






