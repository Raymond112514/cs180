---
layout: post
---

## Fun with Filters and Frequencies

### Fun with filters

Convolution filters are one of the most fundamental operations in image processing, often used to extract or enhance local information within an image. One of the most common types is the gradient filter, defined as

$$\mathbf{D}_x = \begin{bmatrix} -1 & 1 \\
\end{bmatrix} \hspace{20mm} \mathbf{D}_y= \begin{bmatrix}
-1\\
1
\end{bmatrix}$$

Note that the gradient filter is essentially a first-order approximation of the partial derivatives. When applied to the `cameraman` image, the filter captures edge information in both the $x$ and $y$ directions. Intuitively, the derivative signal is large when neighboring pixels differ significantly in intensity.

<div style="display: flex; justify-content: space-between;">
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Original Image</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman.jpg" alt="Image 1" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Gradient in X direction</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_x.jpg" alt="Image 2" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Gradient in Y direction</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_y.jpg" alt="Image 3" style="width: 100%; height: auto;">
  </div>
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Cameran image and the estimated gradient.</p>


We can also compute the magnitude and direction of the gradient, which are given by

$$\begin{align*}
||\nabla f||_2 &= \sqrt{\bigg(\frac{\partial f}{\partial x}\bigg)^2 + \bigg(\frac{\partial f}{\partial y}\bigg)^2}\\
\theta &= \tan^{-1}(\frac{\partial f}{\partial y}\bigg/\frac{\partial f}{\partial x})
\end{align*}$$

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_magnitude.jpg" alt="Image 1" style="width: 40%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_dir.jpg" alt="Image 2" style="width: 40%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

We can filter out the edges by searching for a threshold $\tau$ and binarizing the gradient magnitude image using the condition $\|\nabla f\|_2 \geq \tau$. Searching over $\tau \in (0, 10^{-3})$, we find that $\tau = 0.1929$ gives us the clearest edges. 

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_0.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_1.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_unblurred_2.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Note that the extracted edge signal is weak due to the presence of high-frequency components in the image. To address this, we can blur the image to remove these high-frequency components. This can be achieved by first applying a Gaussian filter to the image, then computing the gradient. Formally, we estimate $\mathbf{D}_x*\(G*I\)$ and $\mathbf{D}_y*\(G*I\)$.

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_x.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_y.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_magnitude.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Another way of performing the operation is to combine the derivate filter and the Gaussian filter together, giving us the derivative of Gaussian (DoG) filter. This gives us the same results.

<div style="display: flex; justify-content: space-between;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_dog_x.jpg" alt="Image 1" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_grad_blurred_dog_y.jpg" alt="Image 2" style="width: 30%; height: auto;">
  <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_dog_magnitude.jpg" alt="Image 3" style="width: 30%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Now, searching over the interval $\tau\in \(0, 1\)$, we see that the optimial threhold gives clearer edge responses. 

<div style="display: flex; justify-content: space-between;">
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Red Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_0.jpg" alt="Image 1" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Green Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_1.jpg" alt="Image 2" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Blue Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/cameraman_blurred_2.jpg" alt="Image 3" style="width: 100%; height: auto;">
  </div>
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>


### Fun with frequencies

In the previous section we see that by removing high frequencies in an image can enahance edge detection effect. We can also play around by manipoulating the high and low frequencies components through the use of Gaussian filters, this allows us to do a lot of interesting things to images. 

#### Image sharpening

One immediate application is image sharpening. An image looks stronger if it has more high frequncy components. This means that if we can extract the high frequency components of the image, then we can sharpen the image by adding more high frequncy components. To extract the high frequency component, we subtract the low frequncy component, derived from the Gaussian filter, from the original image. We combine this into a single filter $$I-G$$.

<div style="display: flex; justify-content: space-between;">
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Red Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj.jpg" alt="Image 1" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Green Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj_low_freq.jpg" alt="Image 2" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 30%;">
    <p style="font-size: small; margin: 5px 0;">Blue Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/tag_high_freq.jpg" alt="Image 3" style="width: 100%; height: auto;">
  </div>
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

Now, by adding the high frequency components, we can sharpen the original image

<div style="display: flex; justify-content: space-between;">
  <div style="text-align: center; width: 23%;">
    <p style="font-size: small; margin: 5px 0;">Red Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj_enhanced_0.jpg" alt="Image 1" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 23%;">
    <p style="font-size: small; margin: 5px 0;">Green Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj_enhanced_1.jpg" alt="Image 2" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 23%;">
    <p style="font-size: small; margin: 5px 0;">Blue Channel</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj_enhanced_2.jpg" alt="Image 3" style="width: 100%; height: auto;">
  </div>
  <div style="text-align: center; width: 23%;">
    <p style="font-size: small; margin: 5px 0;">Combined</p>
    <img src="{{ site.baseurl }}/assets/proj2_images/taj_enhanced_3.jpg" alt="Image 4" style="width: 100%; height: auto;">
  </div>
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, blue channels, and combined image from the glass plate negatives.</p>

We apply this sharpening method to some images of our choice. 

<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
* {box-sizing: border-box}
.mySlides1 {display: none}
.mySlides2 {display: none}
img {vertical-align: middle;}

/* Slideshow container */
.slideshow-container {
  max-width: 1000px;
  position: relative;
  margin: auto;
}

/* Container for side-by-side images */
.image-container {
  display: flex;                /* Use flexbox to arrange images side by side */
  justify-content: space-between; /* Ensure equal space between images */
  align-items: center;          /* Center images vertically if they have different heights */
}

.side-by-side-image {
  width: 32%;                   /* Adjust width to fit three images (less than 33.33%) */
  height: auto;                 /* Maintain aspect ratio */
  border: 2px solid #ccc;       /* Border around each image */
  box-sizing: border-box;       /* Include border in width calculation */
  margin-right: 1%;             /* Add small spacing between images */
}

.side-by-side-image-four {
  width: 23%;                   /* Adjust width to fit four images */
  height: auto;                 /* Maintain aspect ratio */
  border: 2px solid #ccc;       /* Border around each image */
  box-sizing: border-box;       /* Include border in width calculation */
  margin-right: 1%;             /* Add small spacing between images */
}


/* Next & previous buttons */
.prev, .next {
  cursor: pointer;
  position: absolute;
  top: 50%;
  width: auto;
  padding: 16px;
  margin-top: -22px;
  color: white;
  font-weight: bold;
  font-size: 18px;
  transition: 0.6s ease;
  border-radius: 0 3px 3px 0;
  user-select: none;
}

/* Position the "next button" to the right */
.next {
  right: 0;
  border-radius: 3px 0 0 3px;
}

/* On hover, add a black background color with a little bit see-through */
.prev:hover, .next:hover {
  background-color: rgba(0,0,0,0.8);
}

/* The dots/bullets/indicators */
.dot1 {
  cursor: pointer;
  height: 15px;
  width: 15px;
  margin: 0 2px;
  background-color: #bbb;
  border-radius: 50%;
  display: inline-block;
  transition: background-color 0.6s ease;
}

.dot2 {
  cursor: pointer;
  height: 15px;
  width: 15px;
  margin: 0 2px;
  background-color: #bbb;
  border-radius: 50%;
  display: inline-block;
  transition: background-color 0.6s ease;
}

.dot3 {
  cursor: pointer;
  height: 15px;
  width: 15px;
  margin: 0 2px;
  background-color: #bbb;
  border-radius: 50%;
  display: inline-block;
  transition: background-color 0.6s ease;
}

.active, .dot:hover {
  background-color: #717171;
}

/* Fading animation */
.fade {
  animation-name: fade;
  animation-duration: 1.5s;
}

@keyframes fade {
  from {opacity: .4} 
  to {opacity: 1}
}
</style>
</head>

<div class="slideshow-container">

  <div class="mySlides1">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/corgi.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/corgi_blurred.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/corgi_sharpened.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides1">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/old.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/old_blurred.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/old_sharpened.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides1">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/night.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/night_blurred.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/night_sharpened.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides1">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/cell.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/cell_blurred.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/cell_sharpened.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides1">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/sculpture.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/sculpture_blurred.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/sculpture_sharpened.jpg" class="side-by-side-image">
    </div>
  </div>

  <a class="prev" onclick="plusSlides(-1, 0)">❮</a>
  <a class="next" onclick="plusSlides(1, 0)">❯</a>

</div>
<br>

<div style="text-align:center">
  <span class="dot1" onclick="currentSlide(1, 0)"></span> 
  <span class="dot1" onclick="currentSlide(2, 0)"></span> 
  <span class="dot1" onclick="currentSlide(3, 0)"></span> 
  <span class="dot1" onclick="currentSlide(4, 0)"></span> 
  <span class="dot1" onclick="currentSlide(5, 0)"></span> 
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 2:</strong> Alignment result for low resolution images.</p>

#### Hybrid images

It has been observed that high frequency tends to dominate perception when the viewer distance is small and low frequency when the distance is large. By blending both high and low frequency parts of two different images, we can create hybrid images that changes as a function of viewing distance. To create the hybrid image, we follow Olivia et al. approach. The idea is to extract low frequncy from image 1 and high frequency from image 2 and then average the images. Below we show some results for grayscale image.

<div class="slideshow-container">
  <div class="mySlides2">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/young_self.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/old_self.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/young_and_old.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides2">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/raccoon.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/panda.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/raccoon_and_panda.jpg" class="side-by-side-image">
    </div>
  </div>

  <div class="mySlides2">
    <div class="image-container">
      <img src="{{ site.baseurl }}/assets/proj2_images/isaac.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/bull.jpg" class="side-by-side-image">
      <img src="{{ site.baseurl }}/assets/proj2_images/isaac_and_bull.jpg" class="side-by-side-image">
    </div>
  </div>

  <a class="prev" onclick="plusSlides(-1, 1)">❮</a>
  <a class="next" onclick="plusSlides(1, 1)">❯</a>

</div>
<br>

<div style="text-align:center">
  <span class="dot2" onclick="currentSlide(1, 1)"></span> 
  <span class="dot2" onclick="currentSlide(2, 1)"></span> 
  <span class="dot2" onclick="currentSlide(3, 1)"></span> 
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 4:</strong> Pyramid search performs well on most images.</p>

To understand the process of hybrid image, we can visualize the signal capture in each level using fast fourier transform. 

<div style="display: flex; justify-content: center;">
  <img src="{{ site.baseurl }}/assets/proj2_images/fft.png" alt="Image 1" style="width: 100%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

#### Multiresolution blending

<div style="display: flex; justify-content: center;">
  <img src="{{ site.baseurl }}/assets/proj2_images/laplacian.png" alt="Image 1" style="width: 100%; height: auto;">
</div>
<p style="text-align: center; margin-top: 15px;"><strong>Figure 1:</strong> Separate red, green, and blue channels from the glass plate negatives.</p>

<script>
let slideIndex = [1, 1, 1];
let slideId = ["mySlides1", "mySlides2", "mySlides3"]
showSlides(1, 0);
showSlides(1, 1);
showSlides(1, 2);

function currentSlide(n, no) {
  showSlides(slideIndex[no] = n, no);
}

function plusSlides(n, no) {
  showSlides(slideIndex[no] += n, no);
}

function showSlides(n, no) {
  let i;
  let slides = document.getElementsByClassName(slideId[no]);
  let dots = document.getElementsByClassName("dot" + (no + 1)); // Assuming you have separate dot classes for each slider
  
  if (n > slides.length) {slideIndex[no] = 1}    
  if (n < 1) {slideIndex[no] = slides.length}
  
  // Hide all slides for the specific slider
  for (i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";  
  }
  
  // Remove "active" class from all dots for the specific slider
  for (i = 0; i < dots.length; i++) {
    dots[i].className = dots[i].className.replace(" active", "");
  }
  slides[slideIndex[no] - 1].style.display = "block";  
  dots[slideIndex[no] - 1].className += " active";
}
</script>





